const username = document.getElementById("username");
const password = document.getElementById("password");
const checkbox = document.getElementById("checkbox");
const submitBtn = document.getElementById("submit");
const existingBtn = document.getElementById("existing");

// Load saved data on page load
window.onload = function () {
    const savedUser = localStorage.getItem("username");
    const savedPass = localStorage.getItem("password");

    if (savedUser && savedPass) {
        existingBtn.style.display = "inline-block";
        checkbox.checked = true;
    }
};

// Submit button
submitBtn.addEventListener("click", (e) => {
    e.preventDefault(); // Stop form submit reload

    // ðŸ”¥ FIRE ALERT FIRST (Cypress requires this to spy on alert())
    alert(`Logged in as ${username.value}`);

    // ðŸ”¥ THEN handle localStorage (important for tests)
    if (checkbox.checked) {
        localStorage.setItem("username", username.value);
        localStorage.setItem("password", password.value);
    } else {
        localStorage.removeItem("username");
        localStorage.removeItem("password");
    }
});

// Existing user login
existingBtn.addEventListener("click", () => {
    const saved = localStorage.getItem("username");
    if (saved) {
        alert("Logged in as " + saved);
    }
});
